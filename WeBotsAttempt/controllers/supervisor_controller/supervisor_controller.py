from controller import Supervisor
import numpy as np

TIME_STEP = 32

robot = Supervisor()  # create Supervisor instance

case_node=robot.getFromDef('case')
t_field_c = case_node.getField('translation')
r_field_c = case_node.getField('rotation')

pshaft_node=robot.getFromDef('primaryshaft')
t_field_p = pshaft_node.getField('translation')
r_field_p = pshaft_node.getField('rotation')

sshaft_node=robot.getFromDef('secondaryshaft')
t_field_s = sshaft_node.getField('translation')
r_field_s = sshaft_node.getField('rotation')

#tlist=[[-0.89,0,2.28],[-0.89,0,2.43],[-0.877,0,2.59],[-1.2,0,2.78],[-1.28,0,3.05],[-1.21,0,3.26],[-1.15,0,3.42],[-1.1,0,3.52],[-1.08,0,3.57],[-1.3,0,3.87]]
#tlist=[[-0.89, 0.0, 2.28], [-0.9893490579909585, 0.0, 2.4512232391486863], [-0.8686210388898195, 0.0, 2.291771850305832], [-0.837700989298768, 0.0, 2.320828211398666], [-1.2414137523711881, 0.0, 2.671136581238817], [-0.8460286034396969, 0.0, 2.7232085305415152], [-1.0436524342802533, 0.0, 2.641295986959612], [-1.0597418182767253, 0.0, 3.018260828750162], [-1.0460205975519519, 0.0, 2.7214190359190553], [-0.8901362034135176, 0.0, 2.9122705678443914], [-0.9370498250262511, 0.0, 2.860315664872867], [-1.1045580654278375, 0.0, 2.8169807479074347], [-1.167500248220974, 0.0, 3.0118551612126243], [-1.0528622164462198, 0.0, 2.7378322954964465], [-1.0524539535028414, 0.0, 2.736666684333761], [-1.0460001433869814, 0.0, 2.726582432008896], [-1.045976170493226, 0.0, 2.727787878680115], [-1.051273227292688, 0.0, 2.7331573900280626], [-1.045052905190624, 0.0, 2.853720256195396], [-1.0693570623460915, 0.0, 2.773099787434031], [-1.0573055691903315, 0.0, 2.749265813193599], [-1.0258305522421363, 0.0, 2.8706825815759833], [-0.9172939298791878, 0.0, 3.121546214504453], [-1.0740228941488577, 0.0, 2.7805911406851536], [-0.9791827022612571, 0.0, 2.9313626719645147], [-1.1063444020425406, 0.0, 3.0562781597240827], [-1.2789630517686232, 0.0, 3.3631358381189442], [-1.0512633630286738, 0.0, 2.7331271404627033], [-1.0510683143633417, 0.0, 2.732525621218288], [-0.9865339239896169, 0.0, 3.3316519206411748], [-1.2203017454089016, 0.0, 3.1719321479449025], [-1.0454131789975563, 0.0, 2.7388862545348847], [-1.1236744545796697, 0.0, 2.832807412731576], [-1.0861003579001571, 0.0, 3.3101832053817675], [-1.157416044291412, 0.0, 3.204307865225833], [-1.1393181434899515, 0.0, 3.21996007343846], [-1.0442139255184697, 0.0, 2.704486668034174], [-1.1089384410971013, 0.0, 3.2578190219593326], [-1.0352154040702934, 0.0, 2.7880803616175602], [-1.0450820088088653, 0.0, 2.742644111596311], [-1.050130007711507, 0.0, 2.729536316075286], [-1.125153737265439, 0.0, 3.61128905393353], [-1.3, 0.0, 3.87]]
tlist=[[-0.89, 0.0, 2.28], [-1.1398455651449027, 0.0, 2.566962228912965], [-0.9692395840258669, 0.0, 2.6713346352587575], [-1.1079639478017551, 0.0, 2.891906160692003], [-1.3077158297070968, 0.0, 3.1299977295545727], [-1.3783644819556518, 0.0, 3.564401764404385], [-1.1842165090072203, 0.0, 3.612428471557959], [-1.3, 0.0, 3.87]]
#rlist=[[0,1,0,np.pi/2],[0,1,0,1.65],[0,1,0,1.7],[0,1,0,1.8],[0,1,0,1.8],[0,1,0,1.88],[0,1,0,1.95],[0,1,0,2],[0,1,0,2.05],[0,1,0,2.08]]
#rlist= [[0, 1, 0, 1.5707963267948966], [0, 1, 0, 1.6507963267948966], [0, 1, 0, 1.5738472190342527], [0, 1, 0, 1.5995984581158957], [0, 1, 0, 1.7307963267948967], [0, 1, 0, 1.7307963267948967], [0, 1, 0, 1.758228483502088], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8907963267948968], [0, 1, 0, 1.8473337836549923], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8907963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8157290730371152], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.861600597975384], [0, 1, 0, 1.8907963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8528038782648242], [0, 1, 0, 1.880684529687124], [0, 1, 0, 1.960684529687124], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.970796326794897], [0, 1, 0, 1.9316418693215178], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.934870033927675], [0, 1, 0, 1.9531231019853648], [0, 1, 0, 1.925900360339413], [0, 1, 0, 1.6879663709993835], [0, 1, 0, 1.9198696866325369], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 2.040684529687124], [0, 1, 0, 2.08]]
rlist=[[0, 1, 0, 1.5707963267948966], [0, 1, 0, 1.6507963267948966], [0, 1, 0, 1.7307963267948967], [0, 1, 0, 1.8107963267948968], [0, 1, 0, 1.8907963267948968], [0, 1, 0, 1.970796326794897], [0, 1, 0, 2.050796326794897], [0, 1, 0, 2.08]]
# [CODE PLACEHOLDER 1]
sfactor=3
i = 0
initial=1


while robot.step(TIME_STEP) != -1:
    
    # if i==1:
        # print(case_node.getOrientation())
    # if i==20:
        # r_field_p.setSFRotation([0,1,0,0])
    # if i==40:
        # r_field_c.setSFRotation([0,1,0,np.pi/2])
        #t_field_c.setSFVec3f([1,0,0])
    # [CODE PLACEHOLDER 2]
    if i>initial:
        if (i-initial)%sfactor==0 and ((i-initial)/sfactor)<len(tlist):
            j=int((i-initial)/sfactor)
            t_field_p.setSFVec3f(list(np.array(tlist[j])))
            r_field_p.setSFRotation(rlist[j])
    #print('i',i)
    # pshaft_node.setVelocity([0,0,0,0,0,0])
    # print(pshaft_node.getContactPoints())
    i += 1